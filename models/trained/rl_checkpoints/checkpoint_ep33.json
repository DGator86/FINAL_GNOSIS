{
  "episode": 33,
  "agent_stats": {
    "steps": 3320,
    "episodes": 0,
    "epsilon": 0.0543512971290831,
    "buffer_size": 3320,
    "total_reward": -9.403408140558483,
    "avg_loss": 1.7974475899776343
  },
  "config": {
    "num_episodes": 50,
    "max_steps_per_episode": 100,
    "eval_frequency": 10,
    "eval_episodes": 10,
    "early_stopping_patience": 20,
    "min_improvement": 0.01,
    "warmup_episodes": 10,
    "lr_decay_rate": 0.999,
    "min_lr": 1e-05,
    "checkpoint_dir": "models/trained/rl_checkpoints",
    "save_frequency": 100,
    "keep_last_n": 5,
    "log_frequency": 10,
    "tensorboard_dir": null,
    "train_data_ratio": 0.8,
    "validation_data_ratio": 0.1,
    "shuffle_episodes": true,
    "initial_capital": 100000,
    "max_position_size": 0.2,
    "transaction_cost": 0.001,
    "reward_scale": 1.0,
    "risk_penalty": 0.1,
    "drawdown_penalty": 0.5,
    "use_curriculum": true,
    "curriculum_stages": 3
  },
  "agent_config": {
    "state_dim": 17,
    "action_dim": 8,
    "hidden_dims": [
      128,
      64,
      32
    ],
    "learning_rate": 0.001,
    "gamma": 0.99,
    "epsilon_start": 1.0,
    "epsilon_end": 0.01,
    "epsilon_decay": 0.995,
    "buffer_size": 100000,
    "batch_size": 64,
    "min_buffer_size": 1000,
    "target_update_freq": 100,
    "train_freq": 4,
    "profit_reward_scale": 1.0,
    "risk_penalty_scale": 0.5,
    "holding_cost": 0.001,
    "transaction_cost": 0.002
  },
  "best_reward": 27.876269999999998,
  "training_history": [
    {
      "episode": 0,
      "total_reward": 1.5831799999999994,
      "avg_reward": 0.015831799999999993,
      "portfolio_value": 101835.17999999996,
      "max_drawdown": 2.5986820921374303,
      "sharpe_ratio": 3.1227798249974064,
      "win_rate": 0.2,
      "num_trades": 85,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.011283159255981445
    },
    {
      "episode": 1,
      "total_reward": 1.2898099999999826,
      "avg_reward": 0.012898099999999826,
      "portfolio_value": 101389.80999999998,
      "max_drawdown": 0.5215554316222232,
      "sharpe_ratio": 1.205662771926303,
      "win_rate": 0.15,
      "num_trades": 89,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0016698837280273438
    },
    {
      "episode": 2,
      "total_reward": 3.040219999999989,
      "avg_reward": 0.03040219999999989,
      "portfolio_value": 103120.22,
      "max_drawdown": 7.6447785707817095,
      "sharpe_ratio": 2.4151681272488865,
      "win_rate": 0.2,
      "num_trades": 91,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.009799480438232422
    },
    {
      "episode": 3,
      "total_reward": 3.149990000000011,
      "avg_reward": 0.03149990000000011,
      "portfolio_value": 95965.64000000001,
      "max_drawdown": 0.5988384117471361,
      "sharpe_ratio": 0.699498994396882,
      "win_rate": 0.1,
      "num_trades": 84,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.011153459548950195
    },
    {
      "episode": 4,
      "total_reward": 0.4387300000000044,
      "avg_reward": 0.004387300000000044,
      "portfolio_value": 100638.73000000004,
      "max_drawdown": 2.9395741787180616,
      "sharpe_ratio": 0.6916090571287125,
      "win_rate": 0.21,
      "num_trades": 83,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0014917850494384766
    },
    {
      "episode": 5,
      "total_reward": -5.771384999999991,
      "avg_reward": -0.05771384999999991,
      "portfolio_value": 79157.29000000001,
      "max_drawdown": 0.0,
      "sharpe_ratio": -1.5181208952905119,
      "win_rate": 0.16,
      "num_trades": 91,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.007197380065917969
    },
    {
      "episode": 6,
      "total_reward": -8.060944999999988,
      "avg_reward": -0.08060944999999987,
      "portfolio_value": 104438.64499999999,
      "max_drawdown": 0.0,
      "sharpe_ratio": -2.452058641522631,
      "win_rate": 0.16,
      "num_trades": 89,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.011328935623168945
    },
    {
      "episode": 7,
      "total_reward": -15.298575,
      "avg_reward": -0.15298575,
      "portfolio_value": 79236.39499999996,
      "max_drawdown": 74.4948196706643,
      "sharpe_ratio": -3.7223331677751026,
      "win_rate": 0.07,
      "num_trades": 84,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.011466026306152344
    },
    {
      "episode": 8,
      "total_reward": 4.087250000000018,
      "avg_reward": 0.04087250000000018,
      "portfolio_value": 104418.20000000001,
      "max_drawdown": 0.34554947199029634,
      "sharpe_ratio": 1.8797127171186838,
      "win_rate": 0.2,
      "num_trades": 87,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.003035306930541992
    },
    {
      "episode": 9,
      "total_reward": 0.8261299999999985,
      "avg_reward": 0.008261299999999985,
      "portfolio_value": 100996.12999999995,
      "max_drawdown": 0.926393740300759,
      "sharpe_ratio": 0.30430343963668305,
      "win_rate": 0.18,
      "num_trades": 86,
      "epsilon": 0.995,
      "loss": 0.39951144050739607,
      "steps": 100,
      "duration_seconds": 1.5375785827636719
    },
    {
      "episode": 10,
      "total_reward": 0.7380795251396426,
      "avg_reward": 0.007380795251396426,
      "portfolio_value": 97612.99,
      "max_drawdown": 1.502165105163108,
      "sharpe_ratio": 0.5137937515661452,
      "win_rate": 0.2,
      "num_trades": 92,
      "epsilon": 0.8778091417340573,
      "loss": 0.3627628552623182,
      "steps": 100,
      "duration_seconds": 50.39328145980835
    },
    {
      "episode": 11,
      "total_reward": -16.72237999999999,
      "avg_reward": -0.1672237999999999,
      "portfolio_value": 83507.62,
      "max_drawdown": 22.246099224397774,
      "sharpe_ratio": -2.7931404394094566,
      "win_rate": 0.15,
      "num_trades": 93,
      "epsilon": 0.7744209942832988,
      "loss": 0.28675424104900066,
      "steps": 100,
      "duration_seconds": 48.98410177230835
    },
    {
      "episode": 12,
      "total_reward": 0.8425899999999742,
      "avg_reward": 0.008425899999999742,
      "portfolio_value": 92658.48999999999,
      "max_drawdown": 2.1321708871867924,
      "sharpe_ratio": 1.2007213292927004,
      "win_rate": 0.15,
      "num_trades": 92,
      "epsilon": 0.6832098777212641,
      "loss": 0.4367889334876353,
      "steps": 100,
      "duration_seconds": 44.12935996055603
    },
    {
      "episode": 13,
      "total_reward": -7.744580000000016,
      "avg_reward": -0.07744580000000016,
      "portfolio_value": 110751.32000000005,
      "max_drawdown": 4.873069236711905,
      "sharpe_ratio": -1.3694646696248887,
      "win_rate": 0.12,
      "num_trades": 90,
      "epsilon": 0.6027415843082742,
      "loss": 0.33335450586814297,
      "steps": 100,
      "duration_seconds": 43.36192750930786
    },
    {
      "episode": 14,
      "total_reward": -2.566930000000013,
      "avg_reward": -0.02566930000000013,
      "portfolio_value": 84757.11,
      "max_drawdown": 1.9587577195407504,
      "sharpe_ratio": -1.0977898241307043,
      "win_rate": 0.12,
      "num_trades": 91,
      "epsilon": 0.531750826943791,
      "loss": 0.3892489126560787,
      "steps": 100,
      "duration_seconds": 46.12809753417969
    },
    {
      "episode": 15,
      "total_reward": 4.703790000000002,
      "avg_reward": 0.04703790000000002,
      "portfolio_value": 105183.78999999994,
      "max_drawdown": 0.5801273016480338,
      "sharpe_ratio": 0.9351592652388687,
      "win_rate": 0.09,
      "num_trades": 95,
      "epsilon": 0.46912134373457726,
      "loss": 0.3496654972731538,
      "steps": 100,
      "duration_seconds": 45.95250844955444
    },
    {
      "episode": 16,
      "total_reward": 14.307639999999939,
      "avg_reward": 0.14307639999999938,
      "portfolio_value": 117445.87999999993,
      "max_drawdown": 0.2505353452346238,
      "sharpe_ratio": 2.4363612737302667,
      "win_rate": 0.2,
      "num_trades": 99,
      "epsilon": 0.41386834584198684,
      "loss": 0.41738290452569615,
      "steps": 100,
      "duration_seconds": 42.03101420402527
    },
    {
      "episode": 17,
      "total_reward": -4.611875183559663,
      "avg_reward": -0.04611875183559663,
      "portfolio_value": 115370.94000000003,
      "max_drawdown": 1.4214571791252928,
      "sharpe_ratio": -0.4675142540485559,
      "win_rate": 0.1,
      "num_trades": 91,
      "epsilon": 0.36512303261753626,
      "loss": 0.47699195138077966,
      "steps": 100,
      "duration_seconds": 58.45696210861206
    },
    {
      "episode": 18,
      "total_reward": -16.42109000000004,
      "avg_reward": -0.16421090000000038,
      "portfolio_value": 84148.91000000006,
      "max_drawdown": 7.231613732658579,
      "sharpe_ratio": -0.8581847999084264,
      "win_rate": 0.09,
      "num_trades": 94,
      "epsilon": 0.322118930542046,
      "loss": 0.6564544909418253,
      "steps": 100,
      "duration_seconds": 61.32001280784607
    },
    {
      "episode": 19,
      "total_reward": 0.5787257391304741,
      "avg_reward": 0.005787257391304741,
      "portfolio_value": 97234.85999999997,
      "max_drawdown": 11.59859314616027,
      "sharpe_ratio": 0.21927491093479906,
      "win_rate": 0.12,
      "num_trades": 97,
      "epsilon": 0.28417984116121187,
      "loss": 1.2167148263664254,
      "steps": 100,
      "duration_seconds": 225.6845986843109
    },
    {
      "episode": 20,
      "total_reward": -4.16357999999998,
      "avg_reward": -0.0416357999999998,
      "portfolio_value": 41905.42999999997,
      "max_drawdown": 0.0,
      "sharpe_ratio": -1.5356552894556752,
      "win_rate": 0.08,
      "num_trades": 94,
      "epsilon": 0.2507092085103961,
      "loss": 1.2063152474215457,
      "steps": 100,
      "duration_seconds": 229.25404477119446
    },
    {
      "episode": 21,
      "total_reward": -35.1173699999999,
      "avg_reward": -0.35117369999999903,
      "portfolio_value": 66148.27000000005,
      "max_drawdown": 0.0,
      "sharpe_ratio": -1.8034566179627918,
      "win_rate": 0.05,
      "num_trades": 99,
      "epsilon": 0.2211807388415433,
      "loss": 1.1478867246888986,
      "steps": 100,
      "duration_seconds": 347.88294553756714
    },
    {
      "episode": 22,
      "total_reward": 23.447329999999926,
      "avg_reward": 0.23447329999999927,
      "portfolio_value": 131671.2,
      "max_drawdown": 0.12730848651752608,
      "sharpe_ratio": 2.24426406935514,
      "win_rate": 0.08,
      "num_trades": 96,
      "epsilon": 0.19513012515638165,
      "loss": 0.7062568535009791,
      "steps": 100,
      "duration_seconds": 54.43561911582947
    },
    {
      "episode": 23,
      "total_reward": 11.065399999999975,
      "avg_reward": 0.1349439024390241,
      "portfolio_value": 65223.02999999998,
      "max_drawdown": 0.4054832109747256,
      "sharpe_ratio": 2.230966879198008,
      "win_rate": 0.08536585365853659,
      "num_trades": 81,
      "epsilon": 0.17651675623376062,
      "loss": 3.0125501553958958,
      "steps": 82,
      "duration_seconds": 37.81426215171814
    },
    {
      "episode": 24,
      "total_reward": 13.99005000000004,
      "avg_reward": 0.1399005000000004,
      "portfolio_value": 119226.75999999995,
      "max_drawdown": 0.05475591029868922,
      "sharpe_ratio": 4.495814106845709,
      "win_rate": 0.14,
      "num_trades": 98,
      "epsilon": 0.1557266555690826,
      "loss": 2.475290285357397,
      "steps": 100,
      "duration_seconds": 46.76726841926575
    },
    {
      "episode": 25,
      "total_reward": -20.006889999999945,
      "avg_reward": -0.20006889999999944,
      "portfolio_value": 80673.11000000006,
      "max_drawdown": 6.366523377205675,
      "sharpe_ratio": -1.205210732701404,
      "win_rate": 0.09,
      "num_trades": 99,
      "epsilon": 0.13738520790976036,
      "loss": 1.3994848434242662,
      "steps": 100,
      "duration_seconds": 46.849579095840454
    },
    {
      "episode": 26,
      "total_reward": 1.9703125742574008,
      "avg_reward": 0.019703125742574008,
      "portfolio_value": 105256.58999999998,
      "max_drawdown": 0.5640149008241344,
      "sharpe_ratio": 0.7319838242569524,
      "win_rate": 0.07,
      "num_trades": 99,
      "epsilon": 0.12120401149972035,
      "loss": 2.648574701012095,
      "steps": 100,
      "duration_seconds": 49.14964294433594
    },
    {
      "episode": 27,
      "total_reward": -12.82588999999995,
      "avg_reward": -0.1282588999999995,
      "portfolio_value": 105942.08999999997,
      "max_drawdown": 5.702186692901938,
      "sharpe_ratio": -2.073211756366645,
      "win_rate": 0.05,
      "num_trades": 97,
      "epsilon": 0.10692863247165257,
      "loss": 1.1945229275858358,
      "steps": 100,
      "duration_seconds": 47.040775299072266
    },
    {
      "episode": 28,
      "total_reward": -0.9125200000000167,
      "avg_reward": -0.024013684210526753,
      "portfolio_value": 51938.560000000005,
      "max_drawdown": 0.0,
      "sharpe_ratio": -0.7944370372480525,
      "win_rate": 0.10526315789473684,
      "num_trades": 36,
      "epsilon": 0.10170090558064004,
      "loss": 3.8445436241535886,
      "steps": 38,
      "duration_seconds": 17.31791663169861
    },
    {
      "episode": 29,
      "total_reward": 2.2406792857142674,
      "avg_reward": 0.022406792857142675,
      "portfolio_value": 102632.25999999997,
      "max_drawdown": 0.4260547317273479,
      "sharpe_ratio": 0.8707552051481738,
      "win_rate": 0.05,
      "num_trades": 100,
      "epsilon": 0.08972259762946533,
      "loss": 0.4062035609336066,
      "steps": 100,
      "duration_seconds": 47.61858415603638
    },
    {
      "episode": 30,
      "total_reward": 9.52535999999999,
      "avg_reward": 0.0952535999999999,
      "portfolio_value": 114598.78999999998,
      "max_drawdown": 0.14638875538055177,
      "sharpe_ratio": 0.9979950197169822,
      "win_rate": 0.05,
      "num_trades": 99,
      "epsilon": 0.07915509187866444,
      "loss": 2.7229011891624095,
      "steps": 100,
      "duration_seconds": 46.97494959831238
    },
    {
      "episode": 31,
      "total_reward": 10.706164918759233,
      "avg_reward": 0.10706164918759234,
      "portfolio_value": 87536.00999999998,
      "max_drawdown": 0.2503755508074557,
      "sharpe_ratio": 1.8374618365079638,
      "win_rate": 0.04,
      "num_trades": 99,
      "epsilon": 0.06983222438783,
      "loss": 1.5107245919362302,
      "steps": 100,
      "duration_seconds": 43.21489500999451
    },
    {
      "episode": 32,
      "total_reward": 4.41290000000001,
      "avg_reward": 0.044129000000000106,
      "portfolio_value": 120280.52999999998,
      "max_drawdown": 4.62185017652986,
      "sharpe_ratio": 0.7532537152772224,
      "win_rate": 0.03,
      "num_trades": 99,
      "epsilon": 0.061607401965086545,
      "loss": 2.3464961800719513,
      "steps": 100,
      "duration_seconds": 44.26935076713562
    },
    {
      "episode": 33,
      "total_reward": 27.876269999999998,
      "avg_reward": 0.2787627,
      "portfolio_value": 128696.27000000003,
      "max_drawdown": 0.04270721001216516,
      "sharpe_ratio": 2.9630361445942097,
      "win_rate": 0.07,
      "num_trades": 98,
      "epsilon": 0.0543512971290831,
      "loss": 0.6096683987399485,
      "steps": 100,
      "duration_seconds": 45.24161958694458
    }
  ]
}