{
  "episode": 17,
  "agent_stats": {
    "steps": 1800,
    "episodes": 0,
    "epsilon": 0.36512303261753626,
    "buffer_size": 1800,
    "total_reward": 32.26674399728138,
    "avg_loss": 0.33687068984354296
  },
  "config": {
    "num_episodes": 30,
    "max_steps_per_episode": 100,
    "eval_frequency": 10,
    "eval_episodes": 10,
    "early_stopping_patience": 20,
    "min_improvement": 0.01,
    "warmup_episodes": 10,
    "lr_decay_rate": 0.999,
    "min_lr": 1e-05,
    "checkpoint_dir": "models/trained/rl_checkpoints",
    "save_frequency": 100,
    "keep_last_n": 5,
    "log_frequency": 10,
    "tensorboard_dir": null,
    "train_data_ratio": 0.8,
    "validation_data_ratio": 0.1,
    "shuffle_episodes": true,
    "initial_capital": 100000,
    "max_position_size": 0.2,
    "transaction_cost": 0.001,
    "reward_scale": 1.0,
    "risk_penalty": 0.1,
    "drawdown_penalty": 0.5,
    "use_curriculum": true,
    "curriculum_stages": 3
  },
  "agent_config": {
    "state_dim": 17,
    "action_dim": 8,
    "hidden_dims": [
      128,
      64,
      32
    ],
    "learning_rate": 0.001,
    "gamma": 0.99,
    "epsilon_start": 1.0,
    "epsilon_end": 0.01,
    "epsilon_decay": 0.995,
    "buffer_size": 100000,
    "batch_size": 64,
    "min_buffer_size": 1000,
    "target_update_freq": 100,
    "train_freq": 4,
    "profit_reward_scale": 1.0,
    "risk_penalty_scale": 0.5,
    "holding_cost": 0.001,
    "transaction_cost": 0.002
  },
  "best_reward": 15.525128787660705,
  "training_history": [
    {
      "episode": 0,
      "total_reward": -0.6142131182282928,
      "avg_reward": -0.006142131182282929,
      "portfolio_value": 99455.78688177172,
      "max_drawdown": 0.0,
      "sharpe_ratio": -0.5806782402817703,
      "win_rate": 0.09,
      "num_trades": 87,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.026149988174438477
    },
    {
      "episode": 1,
      "total_reward": -2.586760951415253,
      "avg_reward": -0.025867609514152533,
      "portfolio_value": 99538.77120814973,
      "max_drawdown": 3.957093939835285,
      "sharpe_ratio": -1.2066919915207825,
      "win_rate": 0.19,
      "num_trades": 92,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0017414093017578125
    },
    {
      "episode": 2,
      "total_reward": 4.522214061691228,
      "avg_reward": 0.04522214061691228,
      "portfolio_value": 103588.67950697886,
      "max_drawdown": 0.94403125137279,
      "sharpe_ratio": 3.4084411790968625,
      "win_rate": 0.23,
      "num_trades": 88,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.001371145248413086
    },
    {
      "episode": 3,
      "total_reward": 5.016785641897006,
      "avg_reward": 0.050167856418970064,
      "portfolio_value": 104895.96122857326,
      "max_drawdown": 2.760331654927212,
      "sharpe_ratio": 1.93284150259719,
      "win_rate": 0.11,
      "num_trades": 84,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0024149417877197266
    },
    {
      "episode": 4,
      "total_reward": -4.731708467474107,
      "avg_reward": -0.04731708467474107,
      "portfolio_value": 95438.29153252584,
      "max_drawdown": 0.0,
      "sharpe_ratio": -1.8547051565613202,
      "win_rate": 0.11,
      "num_trades": 88,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0016040802001953125
    },
    {
      "episode": 5,
      "total_reward": 1.4751822630814475,
      "avg_reward": 0.014751822630814475,
      "portfolio_value": 101595.18226308144,
      "max_drawdown": 0.675058190871309,
      "sharpe_ratio": 0.807095496394961,
      "win_rate": 0.15,
      "num_trades": 85,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0013353824615478516
    },
    {
      "episode": 6,
      "total_reward": 0.26762683392306763,
      "avg_reward": 0.0026762683392306764,
      "portfolio_value": 97463.55883202307,
      "max_drawdown": 7.796096544389579,
      "sharpe_ratio": 0.18685938909839794,
      "win_rate": 0.23,
      "num_trades": 92,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.013636112213134766
    },
    {
      "episode": 7,
      "total_reward": 8.97535328969235,
      "avg_reward": 0.0897535328969235,
      "portfolio_value": 109165.35328969237,
      "max_drawdown": 0.17511963845036457,
      "sharpe_ratio": 2.1011516958899974,
      "win_rate": 0.14,
      "num_trades": 89,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.0014793872833251953
    },
    {
      "episode": 8,
      "total_reward": 2.0398918620171154,
      "avg_reward": 0.020398918620171153,
      "portfolio_value": 102156.10247344109,
      "max_drawdown": 1.4054738798869422,
      "sharpe_ratio": 1.109203122646962,
      "win_rate": 0.15,
      "num_trades": 92,
      "epsilon": 1.0,
      "loss": 0.0,
      "steps": 100,
      "duration_seconds": 0.003056049346923828
    },
    {
      "episode": 9,
      "total_reward": 5.1565285685866895,
      "avg_reward": 0.05156528568586689,
      "portfolio_value": 105336.52856858677,
      "max_drawdown": 0.38379199367927613,
      "sharpe_ratio": 2.047883695888402,
      "win_rate": 0.15,
      "num_trades": 87,
      "epsilon": 0.995,
      "loss": 0.380709897893086,
      "steps": 100,
      "duration_seconds": 2.4937546253204346
    },
    {
      "episode": 10,
      "total_reward": -0.02365234443041328,
      "avg_reward": -0.0002365234443041328,
      "portfolio_value": 100206.34765556957,
      "max_drawdown": 1.8144864962273834,
      "sharpe_ratio": -0.012969016348109442,
      "win_rate": 0.1,
      "num_trades": 90,
      "epsilon": 0.8778091417340573,
      "loss": 0.29037244391917416,
      "steps": 100,
      "duration_seconds": 220.5690770149231
    },
    {
      "episode": 11,
      "total_reward": 6.93934164479197,
      "avg_reward": 0.0693934164479197,
      "portfolio_value": 107620.46554760478,
      "max_drawdown": 0.2843910938805444,
      "sharpe_ratio": 3.1087373762829986,
      "win_rate": 0.18,
      "num_trades": 93,
      "epsilon": 0.7744209942832988,
      "loss": 0.2936332696425863,
      "steps": 100,
      "duration_seconds": 334.4829614162445
    },
    {
      "episode": 12,
      "total_reward": 13.905953435044458,
      "avg_reward": 0.13905953435044457,
      "portfolio_value": 114345.9534350445,
      "max_drawdown": 0.4348597549898126,
      "sharpe_ratio": 4.248848537897575,
      "win_rate": 0.22,
      "num_trades": 91,
      "epsilon": 0.6832098777212641,
      "loss": 0.32277398210593455,
      "steps": 100,
      "duration_seconds": 51.64055824279785
    },
    {
      "episode": 13,
      "total_reward": -5.813519766914435,
      "avg_reward": -0.05813519766914435,
      "portfolio_value": 95877.08944329803,
      "max_drawdown": 11.161771766615473,
      "sharpe_ratio": -2.0683735134560415,
      "win_rate": 0.12,
      "num_trades": 90,
      "epsilon": 0.6027415843082742,
      "loss": 0.31140547465618573,
      "steps": 100,
      "duration_seconds": 45.319196462631226
    },
    {
      "episode": 14,
      "total_reward": -4.603240065841701,
      "avg_reward": -0.046032400658417016,
      "portfolio_value": 94333.78433317317,
      "max_drawdown": 0.0,
      "sharpe_ratio": -1.1969272696733768,
      "win_rate": 0.07,
      "num_trades": 94,
      "epsilon": 0.531750826943791,
      "loss": 0.27084219683219163,
      "steps": 100,
      "duration_seconds": 44.155786752700806
    },
    {
      "episode": 15,
      "total_reward": -9.474908045684957,
      "avg_reward": -0.09474908045684957,
      "portfolio_value": 85176.64439624682,
      "max_drawdown": 101.76881789349878,
      "sharpe_ratio": -2.4690416638263,
      "win_rate": 0.12,
      "num_trades": 96,
      "epsilon": 0.46912134373457726,
      "loss": 0.3368039998777763,
      "steps": 100,
      "duration_seconds": 44.1414999961853
    },
    {
      "episode": 16,
      "total_reward": -3.7092596311152204,
      "avg_reward": -0.03709259631115221,
      "portfolio_value": 102803.22006718471,
      "max_drawdown": 4.399868491289642,
      "sharpe_ratio": -1.778373376190801,
      "win_rate": 0.07,
      "num_trades": 94,
      "epsilon": 0.41386834584198684,
      "loss": 0.2745859719987648,
      "steps": 100,
      "duration_seconds": 47.16347146034241
    },
    {
      "episode": 17,
      "total_reward": 15.525128787660705,
      "avg_reward": 0.15525128787660705,
      "portfolio_value": 133089.23608997438,
      "max_drawdown": 3.626771260956045,
      "sharpe_ratio": 1.991665642476198,
      "win_rate": 0.1,
      "num_trades": 98,
      "epsilon": 0.36512303261753626,
      "loss": 0.46525059066543933,
      "steps": 100,
      "duration_seconds": 45.56868886947632
    }
  ]
}